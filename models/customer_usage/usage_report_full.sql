{{ config
(
    materialized='table',
    database = 'PROD',
    schema = 'CUSTOMER_USAGE'
)
}}

with saas_usage as (
select distinct
CUSTOMER,
period_start as date,
NUMBER_OF_ARCHIVED_LAYOUTS,
NUMBER_OF_ARCHIVED_RELEASES,
NUMBER_OF_CHARACTERS_COMPLETED,
NUMBER_OF_CORRECT_MACHINE_PREDICTED_NON_STRUCTURED_PAGES,
NUMBER_OF_DOCUMENTS_COMPLETED,
NUMBER_OF_DOCUMENTS_CREATED,
NUMBER_OF_FIELDS_COMPLETED,
NUMBER_OF_FIELDS_CREATED,
NUMBER_OF_FIELDS_EXTRACTED_IN_CUSTOM_SUPERVISION,
NUMBER_OF_FIELDS_EXTRACTED_IN_FLEXIBLE_EXTRACTION,
NUMBER_OF_FIELDS_MACHINE_IDENTIFIED,
NUMBER_OF_FIELDS_MACHINE_TRANSCRIBED,
NUMBER_OF_FIELDS_MANUALLY_INDENTIFIED as NUMBER_OF_FIELDS_MANUALLY_IDENTIFIED,
NUMBER_OF_FIELDS_MANUALLY_TRANSCRIBED,
NUMBER_OF_FILED_SUBMITTED as NUMBER_OF_FILES_SUBMITTED,
NUMBER_OF_INCORRECT_MACHINE_PREDICTED_NON_STRUCTURED_PAGES,
NUMBER_OF_INCREMENTAL_FIELDS_MACHINE_TRANSCRIBED,
NUMBER_OF_LAYOUT_VERSIONS,
NUMBER_OF_LAYOUTS,
NUMBER_OF_LIVE_LAYOUTS,
NUMBER_OF_PAGES_CLASSIFIED_AUTOMATICALLY,
NUMBER_OF_PAGES_CLASSIFIED_MANUALLY,
NUMBER_OF_PAGES_COMPLETED,
NUMBER_OF_PAGES_CREATED,
NUMBER_OF_PAGES_MATCHED_TO_FLEX_LAYOUTS_COMPLETED,
NUMBER_OF_PAGES_MATCHED_TO_FLEX_LAYOUTS_CREATED,
NUMBER_OF_PAGES_MATCHED_TO_FORM_LAYOUTS_COMPLETED,
NUMBER_OF_PAGES_MATCHED_TO_FORM_LAYOUTS_CREATED,
NUMBER_OF_PAGES_WITH_FIELDS_ON_THEM_COMPLETED,
NUMBER_OF_PAGES_WITH_FIELDS_ON_THEM_CREATED,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_MACHINE_FIELD_IDENTIFICATION,
NUMBER_OF_QA_CORECT_RESPONSES_ON_MACHINE_TRANSCRIPTION as NUMBER_OF_QA_CORRECT_RESPONSES_ON_MACHINE_TRANSCRIPTION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_MANUAL_FIELD_IDENTIFICATION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_MANUAL_TRANSCRIPTION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_SYSTEM_FIELD_IDENTIFICATION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_SYSTEM_TRANSCRIPTION,
NUMBER_OF_QA_RESPONSES_ON_MACHINE_FIELD_IDENTIFICATION,
NUMBER_OF_QA_RESPONSES_ON_MACHINE_TRANSCRIPTION,
NUMBER_OF_QA_RESPONSES_ON_MANUAL_FIELD_IDENTIFICATION,
NUMBER_OF_QA_RESPONSES_ON_MANUAL_TRANSCRIPTION,
NUMBER_OF_QA_RESPONSES_ON_SYSTEM_FIELD_IDENTIFICATION,
NUMBER_OF_QA_RESPONSES_ON_SYSTEM_TRANSCRIPTION,
NUMBER_OF_RELEASE_DEPLOYS,
NUMBER_OF_RELEASES,
NUMBER_OF_SUBMISSIONS_COMPLETED,
NUMBER_OF_SUBMISSIONS_CREATED,
NUMBER_OF_TABLE_CELLS_COMPLETED,
NUMBER_OF_TABLE_CELLS_CREATED,
NUMBER_OF_TABLE_CELLS_EXTRACTED_IN_FLEXIBLE_EXTRACTION,
NUMBER_OF_TABLE_CELLS_MACHINE_IDENTIFIED,
NUMBER_OF_CELLS_MANUALLY_IDENTIFIED as NUMBER_OF_TABLE_CELLS_MANUALLY_IDENTIFIED,
NUMBER_OF_UNIQUE_LAYOUTS_MATCHED,
ORGANIZE_DOCUMENTS_NUMBER_OF_DOCUMENTS_CREATED_IN_STEP_1,
ORGANIZE_DOCUMENTS_NUMBER_OF_DOCUMENTS_OUTPUTTED_IN_STEP_1,
ORGANIZE_DOCUMENTS_NUMBER_OF_FOLDERS_CREATED_IN_STEP_2,
ORGANIZE_DOCUMENTS_NUMBER_OF_PAGES_CATEGORIZED_IN_STEP_1,
ORGANIZE_DOCUMENTS_NUMBER_OF_PAGES_SHOWN_IN_STEP_1,
ORGANIZE_DOCUMENTS_NUMBER_OF_TASKS_PERFORMED,
QA_CORRECT_RESPONSES_ON_MACHINE_NON_STRUCTURED_CLASSIFICATION,
QA_CORRECT_RESPONSES_ON_MANUAL_NON_STRUCTURED_CLASSIFICATION,
QA_CORRECT_RESPONSES_ON_SYSTEM_NON_STRUCTURED_CLASSIFICATION,
QA_RESPONSES_ON_MACHINE_NON_STRUCTURED_CLASSIFICATION,
QA_RESPONSES_ON_MANUAL_NON_STRUCTURED_CLASSIFICATION,
QA_RESPONSES_ON_SYSTEM_NON_STRUCTURED_CLASSIFICATION,
SEATS,
SOFTWARE_VERSION
from {{ref('saas_usage')}}
order by customer, date asc
),

on_prem_usage as (
select distinct
trim(CUSTOMER) as CUSTOMER,
DATE,
NUMBER_OF_ARCHIVED_LAYOUTS,
NUMBER_OF_ARCHIVED_RELEASES,
NUMBER_OF_CHARACTERS_COMPLETED,
NUMBER_OF_CORRECT_MACHINE_PREDICTED_NON_STRUCTURED_PAGES,
NUMBER_OF_DOCUMENTS_COMPLETED,
NUMBER_OF_DOCUMENTS_CREATED,
NUMBER_OF_FIELDS_COMPLETED,
NUMBER_OF_FIELDS_CREATED,
NUMBER_OF_FIELDS_EXTRACTED_IN_CUSTOM_SUPERVISION,
NUMBER_OF_FIELDS_EXTRACTED_IN_FLEXIBLE_EXTRACTION,
NUMBER_OF_FIELDS_MACHINE_IDENTIFIED,
NUMBER_OF_FIELDS_MACHINE_TRANSCRIBED,
NUMBER_OF_FIELDS_MANUALLY_IDENTIFIED,
NUMBER_OF_FIELDS_MANUALLY_TRANSCRIBED,
NUMBER_OF_FILES_SUBMITTED,
NUMBER_OF_INCORRECT_MACHINE_PREDICTED_NON_STRUCTURED_PAGES,
NUMBER_OF_INCREMENTAL_FIELDS_MACHINE_TRANSCRIBED,
NUMBER_OF_LAYOUT_VERSIONS,
NUMBER_OF_LAYOUTS,
NUMBER_OF_LIVE_LAYOUTS,
NUMBER_OF_PAGES_CLASSIFIED_AUTOMATICALLY,
NUMBER_OF_PAGES_CLASSIFIED_MANUALLY,
NUMBER_OF_PAGES_COMPLETED,
NUMBER_OF_PAGES_CREATED,
NUMBER_OF_PAGES_MATCHED_TO_FLEX_LAYOUTS_COMPLETED,
NUMBER_OF_PAGES_MATCHED_TO_FLEX_LAYOUTS_CREATED,
NUMBER_OF_PAGES_MATCHED_TO_FORM_LAYOUTS_COMPLETED,
NUMBER_OF_PAGES_MATCHED_TO_FORM_LAYOUTS_CREATED,
NUMBER_OF_PAGES_WITH_FIELDS_ON_THEM_COMPLETED,
NUMBER_OF_PAGES_WITH_FIELDS_ON_THEM_CREATED,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_MACHINE_FIELD_IDENTIFICATION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_MACHINE_TRANSCRIPTION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_MANUAL_FIELD_IDENTIFICATION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_MANUAL_TRANSCRIPTION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_SYSTEM_FIELD_IDENTIFICATION,
NUMBER_OF_QA_CORRECT_RESPONSES_ON_SYSTEM_TRANSCRIPTION,
NUMBER_OF_QA_RESPONSES_ON_MACHINE_FIELD_IDENTIFICATION,
NUMBER_OF_QA_RESPONSES_ON_MACHINE_TRANSCRIPTION,
NUMBER_OF_QA_RESPONSES_ON_MANUAL_FIELD_IDENTIFICATION,
NUMBER_OF_QA_RESPONSES_ON_MANUAL_TRANSCRIPTION,
NUMBER_OF_QA_RESPONSES_ON_SYSTEM_FIELD_IDENTIFICATION,
NUMBER_OF_QA_RESPONSES_ON_SYSTEM_TRANSCRIPTION,
NUMBER_OF_RELEASE_DEPLOYS,
NUMBER_OF_RELEASES,
NUMBER_OF_SUBMISSIONS_COMPLETED,
NUMBER_OF_SUBMISSIONS_CREATED,
NUMBER_OF_TABLE_CELLS_COMPLETED,
NUMBER_OF_TABLE_CELLS_CREATED,
NUMBER_OF_TABLE_CELLS_EXTRACTED_IN_FLEXIBLE_EXTRACTION,
NUMBER_OF_TABLE_CELLS_MACHINE_IDENTIFIED,
NUMBER_OF_TABLE_CELLS_MANUALLY_IDENTIFIED,
NUMBER_OF_UNIQUE_LAYOUTS_MATCHED,
ORGANIZE_DOCUMENTS_NUMBER_OF_DOCUMENTS_CREATED_IN_STEP_1,
ORGANIZE_DOCUMENTS_NUMBER_OF_DOCUMENTS_OUTPUTTED_IN_STEP_1,
ORGANIZE_DOCUMENTS_NUMBER_OF_FOLDERS_CREATED_IN_STEP_2,
ORGANIZE_DOCUMENTS_NUMBER_OF_PAGES_CATEGORIZED_IN_STEP_1,
ORGANIZE_DOCUMENTS_NUMBER_OF_PAGES_SHOWN_IN_STEP_1,
ORGANIZE_DOCUMENTS_NUMBER_OF_TASKS_PERFORMED,
QA_CORRECT_RESPONSES_ON_MACHINE_NON_STRUCTURED_CLASSIFICATION,
QA_CORRECT_RESPONSES_ON_MANUAL_NON_STRUCTURED_CLASSIFICATION,
QA_CORRECT_RESPONSES_ON_SYSTEM_NON_STRUCTURED_CLASSIFICATION,
QA_RESPONSES_ON_MACHINE_NON_STRUCTURED_CLASSIFICATION,
QA_RESPONSES_ON_MANUAL_NON_STRUCTURED_CLASSIFICATION,
QA_RESPONSES_ON_SYSTEM_NON_STRUCTURED_CLASSIFICATION,
SEATS,
SOFTWARE_VERSION
from "FIVETRAN_DATABASE"."GOOGLE_SHEETS"."CUSTOMER_DATA"
order by customer, date asc
),

usage_all as (
select * from saas_usage 
UNION
select * from on_prem_usage
order by customer, date asc
)

select * from usage_all